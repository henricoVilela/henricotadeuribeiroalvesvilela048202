<app-layout>
    @if (loading()) {
    <app-loading [fullPage]="true" text="Carregando artista..." />
    } @else if (artista()) {
    <div class="space-y-6">
        <!-- Header -->
        <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4">
        <div class="flex items-center gap-4">
            <a routerLink="/artistas" class="text-gray-500 hover:text-gray-700">
            ← Voltar
            </a>
            <div>
            <h1 class="text-2xl font-bold text-gray-900">{{ artista()!.nome }}</h1>
            <p class="text-gray-600">{{ artista()!.tipoDescricao }}</p>
            </div>
        </div>
        <div class="flex gap-2">
            <a 
            [routerLink]="['/artistas', artista()!.id, 'editar']"
            class="btn btn-outline"
            >
            Editar
            </a>
            <button (click)="showDeleteDialog.set(true)" class="btn btn-danger">
            Excluir
            </button>
        </div>
        </div>
        
        <!-- Info Cards -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <div class="card card-body">
            <h2 class="text-lg font-semibold text-gray-900 mb-4">Informações</h2>
            <dl class="space-y-3">
            <div class="flex justify-between">
                <dt class="text-gray-500">Tipo</dt>
                <dd class="font-medium">{{ artista()!.tipoDescricao }}</dd>
            </div>
            <div class="flex justify-between">
                <dt class="text-gray-500">País de Origem</dt>
                <dd class="font-medium">{{ artista()!.paisOrigem || '-' }}</dd>
            </div>
            <div class="flex justify-between">
                <dt class="text-gray-500">Ano de Formação</dt>
                <dd class="font-medium">{{ artista()!.anoFormacao || '-' }}</dd>
            </div>
            <div class="flex justify-between">
                <dt class="text-gray-500">Total de Álbuns</dt>
                <dd class="font-medium">{{ artista()!.totalAlbuns }}</dd>
            </div>
            <div class="flex justify-between">
                <dt class="text-gray-500">Status</dt>
                <dd>
                @if (artista()!.ativo) {
                    <span class="badge badge-success">Ativo</span>
                } @else {
                    <span class="badge badge-danger">Inativo</span>
                }
                </dd>
            </div>
            </dl>
        </div>
        
        @if (artista()!.biografia) {
            <div class="card card-body">
            <h2 class="text-lg font-semibold text-gray-900 mb-4">Biografia</h2>
            <p class="text-gray-700 whitespace-pre-line">{{ artista()!.biografia }}</p>
            </div>
        }
        </div>
        
        <!-- Albums -->
        <div class="card">
        <div class="card-header flex items-center justify-between">
            <h2 class="text-lg font-semibold text-gray-900">
            Álbuns ({{ albuns().length }})
            </h2>
            <a 
            routerLink="/albuns/novo" 
            [queryParams]="{artistaId: artista()!.id}"
            class="btn btn-primary btn-sm"
            >
            + Novo Álbum
            </a>
        </div>
        <div class="card-body">
            @if (loadingAlbuns()) {
            <app-loading text="Carregando álbuns..." />
            } @else if (albuns().length === 0) {
            <p class="text-gray-500 text-center py-8">
                Este artista ainda não possui álbuns cadastrados
            </p>
            } @else {
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
                @for (album of albuns(); track album.id) {
                <a 
                    [routerLink]="['/albuns', album.id]"
                    class="block p-4 border border-gray-200 rounded-lg hover:border-primary-500 hover:shadow-md transition-all"
                >
                    <h3 class="font-medium text-gray-900">{{ album.nome }}</h3>
                    <p class="text-sm text-gray-500 mt-1">
                    {{ album.anoLancamento || 'Ano não informado' }}
                    @if (album.genero) {
                        • {{ album.genero }}
                    }
                    </p>
                    @if (album.totalCapas > 0) {
                    <p class="text-xs text-primary-600 mt-2">
                        {{ album.totalCapas }} capa(s)
                    </p>
                    }
                </a>
                }
            </div>
            }
        </div>
        </div>
    </div>
    
    <!-- Delete Confirmation -->
    <app-confirm-dialog
        [isOpen]="showDeleteDialog()"
        title="Excluir Artista"
        [message]="'Tem certeza que deseja excluir o artista ' + artista()!.nome + '? Esta ação não pode ser desfeita.'"
        confirmText="Excluir"
        type="danger"
        (confirm)="deleteArtista()"
        (cancel)="showDeleteDialog.set(false)"
    />
    }
</app-layout>